# See https://docs.astral.sh/ruff/configuration/
# For a full list of supported rules, see https://docs.astral.sh/ruff/rules/
# For a full list of options, see https://docs.astral.sh/ruff/settings/

# Same as Black.
line-length = 80
# Assume Python 3.7+
target-version = "py37"

# The gRPC project has a lot of generated code.
# We exclude them here. This is based on black.toml
# and tools/distrib/ruff_code.sh
exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".hg",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "venv",
    "site-packages",
    "test/cpp/naming/resolver_component_tests_runner.py",  # AUTO-GENERATED
    "grpc_version.py", # AUTO-GENERATED from a template
    "python_version.py", # AUTO-GENERATED from a template
    "src/python/grpcio/grpc_core_dependencies.py", # AUTO-GENERATED from a template
    "src/python/grpcio/grpc/_grpcio_metadata.py", # AUTO-GENERATED from a template
    "tools/distrib/python/grpcio_tools/protoc_lib_deps.py", # AUTO-GENERATED BY make_grpcio_tools.py
    "src/python/grpcio_observability/observability_lib_deps.py", # AUTO-GENERATED BY make_grpcio_observability.py
    ".*_pb2.py",  # autogenerated Protocol Buffer files
    ".*_pb2_grpc.py",  # autogenerated Protocol Buffer gRPC files
    "tools/distrib/python/xds_protos/.*" # AUTO-GENERATED By tools/distrib/python/xds_protos/build.py
]

[lint]
# Select all rules by default, and then ignore the ones we don't want.
# This is a good way to stay up-to-date with new rules in ruff.
select = ["ALL"]

# Rules that are often controversial or don't fit the gRPC project.
# This list is based on the .pylintrc file and general good practice.
# It's a starting point and can be customized.
ignore = [
    "D",  # pydocstyle
    "ANN", # flake8-annotations
    "S101", # assert
    "C901", # mccabe complexity
    "EM", # flake8-errmsg
    "E501", # line too long, handled by 'format'
    "PLR0913", # too-many-arguments
    "PLR0912", # too-many-branches
    "PLR0915", # too-many-statements
    "PLR0911", # too-many-return-statements
    "PLR2004", # magic-value-comparison
    "N802", # invalid-function-name
    "N803", # invalid-argument-name
    "N806", # invalid-variable-name
    "N818", # error-suffix-in-exception-name
]

# Allow unused variables that match these patterns.
dummy-variable-rgx = "^(_+|ignored_)"

[format]
# Like Black, use double quotes for strings.
quote-style = "double"
# Like Black, indent with 4 spaces.
indent-style = "space" 